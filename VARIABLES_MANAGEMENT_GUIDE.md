# 변수 관리 시스템 가이드

## 개요
좌측 "설정" 메뉴 하위의 "변수 관리" 메뉴를 통해 settings 테이블의 name, value 컬럼을 CRUD 기능으로 관리하는 시스템입니다. 학생 앱에서 사용할 변수들을 관리할 수 있습니다.

## 기능 소개

### 🔧 변수 관리 메뉴
- **위치**: 좌측 사이드바 > 설정 > 변수 관리
- **경로**: `/admin/settings/variables`

### 📋 주요 기능

#### 1. 변수 목록 조회
- 등록된 모든 변수를 테이블 형태로 표시
- 변수명(name), 값(value), 생성일 정보 표시
- 생성일 기준 내림차순 정렬

#### 2. 변수 추가
- "변수 추가" 버튼 클릭으로 새 변수 등록
- 필수 항목: 변수명(name), 값(value)
- 변수명 중복 체크 (이미 존재하는 변수명은 추가 불가)

#### 3. 변수 수정
- 각 변수 행의 "수정" 버튼으로 정보 변경
- 변수명과 값 모두 수정 가능
- 변수명 중복 체크 (다른 변수와 중복 불가)

#### 4. 변수 삭제
- 각 변수 행의 "삭제" 버튼으로 변수 제거
- 삭제 확인 다이얼로그 표시
- 삭제 후 되돌릴 수 없음

## 데이터베이스 구조

### Settings 테이블
```sql
CREATE TABLE settings (
  id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  name TEXT,                              -- 변수명
  value TEXT,                             -- 변수 값
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**테이블 코멘트:**
- `COMMENT ON TABLE settings IS '시스템 설정을 저장.';`

## API 엔드포인트

### 1. 변수 목록 조회
```
GET /api/admin/settings
```
**응답:**
```json
{
  "success": true,
  "settings": [
    {
      "id": 1,
      "name": "app_version",
      "value": "1.0.0",
      "created_at": "2025-01-15T10:30:00.000Z"
    }
  ]
}
```

### 2. 변수 추가
```
POST /api/admin/settings
```
**요청 본문:**
```json
{
  "name": "app_version",
  "value": "1.0.0"
}
```
**응답:**
```json
{
  "success": true,
  "setting": {
    "id": 1,
    "name": "app_version",
    "value": "1.0.0",
    "created_at": "2025-01-15T10:30:00.000Z"
  }
}
```
**에러 응답 (중복 변수명):**
```json
{
  "error": "이미 존재하는 변수명입니다."
}
```

### 3. 변수 수정
```
PUT /api/admin/settings/[id]
```
**요청 본문:**
```json
{
  "name": "app_version",
  "value": "1.0.1"
}
```
**응답:**
```json
{
  "success": true,
  "setting": {
    "id": 1,
    "name": "app_version",
    "value": "1.0.1",
    "created_at": "2025-01-15T10:30:00.000Z"
  }
}
```

### 4. 변수 삭제
```
DELETE /api/admin/settings/[id]
```
**응답:**
```json
{
  "success": true,
  "message": "설정이 성공적으로 삭제되었습니다."
}
```

## 보안 및 권한

### 접근 권한
- 관리자 페이지 접근 권한이 있는 사용자만 접근 가능
- 인증되지 않은 사용자는 로그인 페이지로 리다이렉트

### 데이터 검증
- 변수명(name)과 값(value)은 필수 항목
- 변수명 중복 방지 (추가 및 수정 시 체크)
- 빈 값 입력 방지

## 사용 예시

### 1. 새 변수 추가
1. 좌측 사이드바에서 "설정" > "변수 관리" 클릭
2. "변수 추가" 버튼 클릭
3. 변수명 입력 (예: `app_version`)
4. 값 입력 (예: `1.0.0`)
5. "추가" 버튼 클릭

### 2. 변수 수정
1. 수정할 변수 행의 "수정" 버튼 클릭
2. 변수명 또는 값 수정
3. "수정" 버튼 클릭

### 3. 변수 삭제
1. 삭제할 변수 행의 "삭제" 버튼 클릭
2. 확인 다이얼로그에서 "삭제" 클릭

## 학생앱 변수관리 그룹

변수 관리 페이지에는 "학생앱 변수관리" 그룹이 표시됩니다. 이 그룹은 학생 앱에서 사용할 변수들을 관리하기 위한 섹션입니다.

### 주요 특징
- 학생 앱에서 사용할 설정값들을 중앙에서 관리
- 앱 버전, API 엔드포인트, 기능 플래그 등 다양한 변수 관리 가능
- 실시간으로 변수 값 변경 가능

## 확장 가능성

### 추가 기능 아이디어
1. **변수 그룹화**: 카테고리별로 변수 분류 (학생앱, 관리자앱 등)
2. **변수 검색**: 변수명으로 검색 기능
3. **변수 히스토리**: 변수 값 변경 이력 추적
4. **변수 타입**: 문자열, 숫자, 불린 등 타입 지정
5. **변수 설명**: 각 변수에 대한 설명 필드 추가
6. **대량 수정**: 여러 변수를 한 번에 수정
7. **변수 가져오기/내보내기**: CSV 또는 JSON 형식으로 변수 내보내기/가져오기

### 다른 시스템과의 연동
- 학생 앱에서 API를 통해 변수 값 조회
- 관리자 앱에서 변수 값 변경 시 실시간 반영
- 환경별 변수 관리 (개발, 스테이징, 프로덕션)

## 주의사항

1. **변수명 규칙**: 변수명은 고유해야 하며, 중복된 변수명은 추가할 수 없습니다.
2. **삭제 주의**: 변수를 삭제하면 해당 변수는 완전히 제거되며, 학생 앱에서 참조하는 경우 오류가 발생할 수 있습니다.
3. **값 형식**: 현재는 텍스트 형식만 지원하며, JSON이나 숫자 형식의 값은 문자열로 저장됩니다.

## 기술 스택

- **프론트엔드**: React, Next.js, TypeScript
- **UI 컴포넌트**: shadcn/ui (Table, Dialog, Button 등)
- **백엔드**: Next.js API Routes
- **데이터베이스**: Supabase (PostgreSQL)
- **상태 관리**: React Hooks (useState, useEffect)
- **알림**: Toast 컴포넌트

## 파일 구조

```
src/
├── app/
│   ├── admin/
│   │   └── settings/
│   │       └── variables/
│   │           └── page.tsx          # 변수 관리 페이지
│   └── api/
│       └── admin/
│           └── settings/
│               ├── route.ts          # GET, POST 엔드포인트
│               └── [id]/
│                   └── route.ts     # PUT, DELETE 엔드포인트
└── components/
    └── admin/
        └── VariablesManagement.tsx   # 변수 관리 컴포넌트
```

